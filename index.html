<!doctype html>

<html lang=en>

<head>
    <meta charset=utf-8>
    <title>AGAR AGAR</title>
    <meta name="description" content="control the flow">
    
    <meta name="author" content="Eberhard Gräther">
    <meta name="author" content="Thomas Kempf">
    <meta name="author" content="Sebastian Kienzl">
    <meta name="author" content="Sebastian Köck">
    <meta name="author" content="Franz Lanzendorfer">
    <meta name="author" content="Benjamin Medicke">
    
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
</head>
<body>
    
    <canvas id="canvas">Your browser does not support &lt;canvas&gt;.</canvas>
    <div id="overlay"></div>

    <div class="rounded item" id="playpause" style="padding-top: 2px; background-image:url(images/pause.png);background-position: 96px 50%;background-repeat:no-repeat;" >
        AGAR AGAR
    </div>
    
    <div class="rounded item" id="stopmusic" style="padding-top: 2px; background-image:url(images/sound_on.png);background-position: 50% 50%;background-repeat:no-repeat;" >
        &nbsp;
    </div>

    <div class="rounded item" id="menu">
        <p id="newg">New Game</p>
        <p id="inst">Instructions</p>
        <p id="vers">Versions</p>
        <p id="abou">About</p>
        <p id="dona">Donate</p>
    </div>

    <div id="points">
        <span id="pointvalue">0</span><span id="pointlabel">Points</span>
    </div>

    <div class="info rounded" id="newgame">
        <h2>Start a new game?</h2>
        <a href="#" class="rounded" id="startnewgame">YES</a>
    </div>

    <div class="info rounded" id="instructions">
        <h2>Instructions</h2>
        
        <p>Drag your cursor over the culture medium to create a drift. Move your microorganisms towards each other so they can reproduce. Once you have produced enough microorganisms, move them to the destination cells in order to infiltrate them.</p>
        
        <p>However, watch out for leukocytes and ciliated cells which feed upon your organisms.</p>
    </div>

    <div class="info rounded" id="versions">
        <h2>Versions</h2>
        
        <p><a href="http://agaragargame.com" class="rounded button">Latest Release</a></p>
        
        <p>Links to older Versions of Agar Agar</p>
        <p><a href="http://agaragargame.com/v0.6" class="rounded button">v0.6</a></p>
        <p><a href="http://agaragargame.com/v0.5" class="rounded button">v0.5</a></p>
    </div>

    <div class="info rounded" id="about">
        <h2>About</h2>
        <p>Agar Agar was developed as a semester-project at the University of Applied Sciences Salzburg by:</p>
        <p class="aufzaehlung">Eberhard Gräther (Gamedesign, Game Development)</p>
        <p class="aufzaehlung">Thomas Kempf (Gamedesign)</p>
        <p class="aufzaehlung">Sebastian Kienzl (Gamedesign, Art Direction)</p>
        <p class="aufzaehlung">Sebastian Köck (Gamedesign, Art Direction)</p>
        <p class="aufzaehlung">Franz Lanzendorfer (Gamedesign, Game Development)</p>
        <p class="aufzaehlung">Benjamin Medicke (Gamedesign, Game Development)</p>
    </div>

    <div class="info rounded" id="donate">
        <h2>Donate</h2>
        <p>If you like our game, please reward the work we put in it with a little donation here:</p>
    </div>

    <div class="info rounded" id="loser">
        <h2>There are none of your organisms left! Your Score:</h2>
        <h2 id="score">0</h2>
        <p>Share on: 
            <a href="#" class="rounded button" id="facebooklink">Facebook</a> or 
            <a href="https://twitter.com/?status=Check%20out%20%23AgarAgar%21%20http%3A%2F%2Fagaragargame.com%2F" class="rounded button" id="twitterlink">Twitter</a>.
        </p>
    </div>
    
    <div class="info rounded" id="error">
        <h2>ERROR</h2>
        <p>Your browser does not support WebGL.</p>
        <a href="http://get.webgl.org" class="rounded button">Get WebGL</a></p>
    </div>

<script id="vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec3 position;
    
    void main(void) {
    
       gl_Position = matrix * vec4(position, 1.0);
       gl_PointSize = 3.0;
    
    }
    
</script>

<script id="fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif
    
    uniform vec4 color;
    
    void main(void) {
    
       gl_FragColor = color;
       
    }
    
</script>

<script id="stardust-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec3 position;
    
    varying float alpha;
    
    void main(void) {
    
       gl_Position = matrix * vec4(position.xy, 1.0, 1.0);
       
       gl_PointSize = 2.0;
       
       alpha = position.z;
    
    }
    
</script>

<script id="stardust-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif
    
    uniform vec4 color;
    
    varying float alpha;
    
    void main(void) {
    
       gl_FragColor = vec4(.85, .85, .85, alpha);
       
    }
    
</script>

<script id="particle-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;
    uniform float size;

    attribute vec4 position;
    
    varying float alpha;
    varying float time;
    
    void main(void) {
    
       gl_Position = matrix * vec4(position.xy, 1.0, 1.0);
       
       gl_PointSize = size;
       
       alpha = position.z;
       
       time = position.w;
    
    }
    
</script>

<script id="particle-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif
    
    uniform sampler2D texture;
    
    varying float alpha;
    
    varying float time;
    
    const vec2 center = vec2(0.5, 0.5);
    
    void main(void) {
    
        vec2 point = ( gl_PointCoord - center );

        point *= 1.0 + 0.50 / 12.0 * sin( 2.0 * atan( point.y, point.x ) + time * 5.0 ) +
                       0.50 / 12.0 * sin( 3.0 * atan( point.y, point.x ) - time * 2.5 );

        gl_FragColor = texture2D( texture, point + center );
        gl_FragColor.a *= alpha * 1.5;
       
    }
    
</script>

<script id="leukocyte-vertex-shader" type="x-shader/x-vertex" charset="utf-8">
    
    uniform mat4 matrix;
    uniform float size;
    uniform float radius;

    attribute vec2 position;
    attribute vec3 params;

    varying float factor;
    varying float rotation;
    varying float time;
    
    const float PI = 3.1415926535897932384626433832;

    void main(void) {

        gl_Position = matrix * vec4( position, 1.0, 1.0 );
    
        gl_PointSize = size;
    
        float distance = clamp( params.x, 0.0, radius * 2.0 );
        factor = sin( distance / ( radius * 2.0 ) * PI );
        
        rotation = -params.y;
        time = params.z;
        
    }
    
</script>

<script id="leukocyte-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif

    uniform sampler2D texture;
    uniform float radius;

    varying float factor;
    varying float rotation;
    varying float time;

    const vec2 center = vec2( 0.5, 0.5 );

    void main(void) {
        
        vec2 point = ( gl_PointCoord - center ) * 2.0;
            
        point = vec2(
            cos( rotation ) * point.x - sin( rotation ) * point.y,
            sin( rotation ) * point.x + cos( rotation ) * point.y
        );
        
        float stretchFactor = factor * ( cos( atan( point.y, point.x ) ) * 0.5 + 0.5 );
        float crushFactor = factor * ( sin( atan( point.y, point.x ) ) * 0.5 + 0.5 );
        
        vec2 stretch = vec2( 1.0, 0.0 ) * stretchFactor * 0.1;
        vec2 crush = vec2( 0.0, 1.0 ) * crushFactor * 0.1;
        
        point -= stretch - crush;
        
        point *= 1.0 + radius / 4.0 * 
            sin( 2.0 * atan( point.y, point.x ) + time * 2.0 ) *
            sin( 9.0 * atan( point.y, point.x ) - time * 4.0 );  
        
        // point *= 1.0 + radius / 5.0 * 
        //     sin( 5.0 * atan( point.y, point.x ) + time * 2.0 ) *
        //     sin( 6.0 * atan( point.y, point.x ) - time * 5.0 );
        
        gl_FragColor = texture2D( texture, point + center );
        gl_FragColor.a *= 2.0;
    }
    
</script>

<script id="devourer-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec2 position;
    attribute vec2 textureCoord;
    
    varying vec2 pointCoord;

    void main(void) {

       gl_Position = matrix * vec4(position, 1.0, 1.0);
       
       pointCoord = textureCoord;

    }
    
</script>

<script id="devourer-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif

    const float PI = 3.1415926535897932384626433832;

    uniform sampler2D corpusTexture;
    uniform sampler2D tentacleTexture;
    
    uniform float speed;
    
    varying vec2 pointCoord;

    const vec3 color = vec3(0.0, 0.0, 0.0);
    const vec3 color2 = vec3(0.9, 0.9, 0.95);
    const vec2 mid = vec2(0.5, 0.5);
    
    vec2 rotate( vec2 vector, float angle ) {
    
        return vec2(
            cos( angle ) * vector.x - sin( angle ) * vector.y,
            sin( angle ) * vector.x + cos( angle ) * vector.y
        );
        
    }

    void main(void) {
        
        gl_FragColor.rgb = color;
        
        vec2 vector = pointCoord - mid;
        float angle = length( vector ) * speed * 1.5;
        
        float alpha = 0.0;
   
        alpha += texture2D( tentacleTexture, mid + rotate( vector, angle ) ).a * 0.3;
        alpha += texture2D( tentacleTexture, mid + rotate( vector * 0.9, angle * 1.1 + 0.2 ) ).a * 0.2;
        alpha += texture2D( tentacleTexture, mid + rotate( vector * 0.95, angle * 1.15 + 0.15 ) ).a * 0.1;
        
        gl_FragColor.a = alpha;
        
        vec4 corpus = vec4( color2, texture2D( corpusTexture, (pointCoord - mid / 2.0 ) * 2.0 ).a * 1.2 );
        
        gl_FragColor = mix( gl_FragColor, corpus, step( length( vector ), 0.215 ) * 0.8 );
        
    }
    
</script>

<script id="cytoplast-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec2 position;
    attribute vec2 textureCoord;
    
    varying vec2 pointCoord;

    void main(void) {

       gl_Position = matrix * vec4(position, 1.0, 1.0);

       pointCoord = textureCoord;

    }
    
</script>

<script id="cytoplast-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif

    uniform sampler2D texture;
	
	uniform vec4 color;

    varying vec2 pointCoord;

    void main(void) {
        
        // gl_FragColor = texture2D( texture, pointCoord );

		vec4 textureColor = texture2D( texture, pointCoord );
		
		gl_FragColor = vec4(mix(textureColor.rgb, color.rgb, color.a), textureColor.a);
   
    }
    
</script>

<script id="vectorfield-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec4 position;
    
    varying float rotation;
    
    void main(void) {
    
        gl_Position = matrix * vec4(position.xy, 1.0, 1.0);
        
        gl_PointSize = position.z;
        
        rotation = -position.w;
    
    }
    
</script>

<script id="vectorfield-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif
    
    uniform sampler2D texture;
    
    varying float rotation;
    
    const vec2 center = vec2( 0.5, 0.5 );
    const vec3 color = vec3( 0.3, 0.3, 0.3 );
    
    void main(void) {
        
        vec2 point = gl_PointCoord - center;
        
        point = vec2(
            cos( rotation ) * point.x - sin( rotation ) * point.y,
            sin( rotation ) * point.x + cos( rotation ) * point.y
        ) + center;
        
        gl_FragColor.a = texture2D( texture, point ).a;
        gl_FragColor.rgb = color;
    }
    
</script>

<script id="glow-vertex-shader" type="x-shader/x-vertex" charset="utf-8">

    uniform mat4 matrix;

    attribute vec2 position;
    attribute vec2 textureCoord;
    
    varying vec2 pointCoord;
    
    void main(void) {
    
       gl_Position = matrix * vec4(position, 1.0, 1.0);
       pointCoord = textureCoord;
    
    }
    
</script>

<script id="glow-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif
    
    uniform sampler2D texture;
    
    varying vec2 pointCoord;
    
    const vec3 color = vec3(0.7, 0.9, 0.7);
    
    void main(void) {
    
       gl_FragColor.rgb = color;
       gl_FragColor.a = texture2D( texture, pointCoord ).a * 2.3;
       gl_FragColor.a *= step( 0.72, gl_FragColor.a );
       
       //gl_FragColor = texture2D( texture, pointCoord );
       //gl_FragColor.a *= 2.3;
       
    }
    
</script>

<script id="entropyfier-vertex-shader" type="x-shader/x-vertex" charset="utf-8">
    
    uniform mat4 matrix;

    attribute vec3 position;
    
    varying vec2 vPosition;

    void main(void) {

        gl_Position = matrix * vec4( position, 1.0 );
        
        vPosition = position.xy;
        
    }
    
</script>

<script id="entropyfier-fragment-shader" type="x-shader/x-fragment" charset="utf-8">

    #ifdef GL_ES
       precision highp float;
    #endif

    uniform float lifeTime;

    varying vec2 vPosition;
    
    const vec3 borderColor = vec3(0.9, 0.9, 0.9);
    const vec3 fillColor = vec3(0.97, 0.97, 0.97);
    
    const vec3 whiteColor = vec3(1.0, 1.0, 1.0);
    const vec2 glowCenter = vec2( -0.3, -0.3 );
    
    const float outerRadius = 1.0;
    
    const float PI = 3.1415926535897932384626433832;

    void main(void) {

        float len = length( vPosition );

        float alphaFactor = clamp( 40.0 - 40.0 * len, 0.0, 1.0);

        gl_FragColor.a = max( 1.0, sqrt( lifeTime ) ) * alphaFactor;

        float innerRadius = 0.57 + lifeTime / 3.0;
        
        float mixFactor = cos( ( clamp( len, innerRadius, outerRadius ) - innerRadius ) / ( outerRadius - innerRadius ) * 2.0 * PI) * -0.5 + 0.5;
        
        mixFactor *= step( innerRadius, len ) * step( len, outerRadius );
        
        vec3 color = mix( fillColor, borderColor, mixFactor );
        
        // glow
        // color = mix( whiteColor, color, length( vPosition - glowCenter ) * 2.0 );
        
        gl_FragColor.rgb = mix( whiteColor, color, lifeTime * 0.5 );

    }
    
</script>

<script type='text/javascript' src="http://code.jquery.com/jquery-1.5.js" charset="utf-8"></script>
<script type='text/javascript' src="./js/Menu.js" charset="utf-8"></script>
<script type='text/javascript' src="./js/Animator.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/requestAnimationFrame.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/utilities.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/Vector.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Matrix.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/WebGLTexture.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/WebGLShader.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/WebGLUtilities.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/Entity.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Particle.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Leukocyte.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Cytoplast.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Devourer.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Entropyfier.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/Glow.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/DustParticle.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Stardust.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/Vectorfield.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/InputHandler.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/Controller.js" charset="utf-8"></script>

<script type="text/javascript" src="./js/Game.js" charset="utf-8"></script>
<script type="text/javascript" src="./js/agar-agar.js" charset="utf-8"></script>

</body>
</html>